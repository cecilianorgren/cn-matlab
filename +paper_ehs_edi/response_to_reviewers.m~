% Figures for respone to reviewers


%% Non-linear relation between dn and phi
f_phi = @(x,lx,phi0) phi0.*exp(-x.^2./(lx.^2));
f_E = @(x,lx,phi0) phi0.*exp(-x.^2./(lx.^2));

lx = 1;
x = linspace(-3*lx,3*lx,100);

plot(x,f_phi(x,lx,1))

%% Non-linear relation between dn and phi, symbolic expressions
units = irf_units;
num_lx = 1;
%phimax = 1;
syms x v phimax lx %phi(x) f0(v) ff(x,v) v0(x,v)
f_phi(x,phimax,lx) = phimax*exp(-x.^2/2/lx.^2);
f_E = -diff(f_phi,x);
f_dn = -diff(units.eps0/units.e*f_phi,x,2); % dn = -diff(E,x); % the same, dn = ne-ni

vecx = linspace(-3,3,100);
vecphimax = 0:100;
veclx = linspace(0.5,5,100);

h = setup_subplots(4,1);
isub = 1;

hca = h(isub); isub = isub + 1;
plot(hca,vecx,double(f_phi(vecx,1,1)))
hca.XLabel.String = 'x';
hca.YLabel.String = '\phi';

hca = h(isub); isub = isub + 1;
plot(hca,vecx,double(f_E(vecx,1,1)))
hca.XLabel.String = 'x';
hca.YLabel.String = 'E';

hca = h(isub); isub = isub + 1;
plot(hca,vecx,double(f_dn(vecx,1,1)))
hca.XLabel.String = 'x';
hca.YLabel.String = '\delta n';

hca = h(isub); isub = isub + 1;
scatter(hca,veclx,double(f_dn(0,1,veclx)))
hca.XLabel.String = 'l_x';
hca.YLabel.String = '\delta n';